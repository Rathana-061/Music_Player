<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Register</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #71b7e6, #9b59b6);
        }

        .container {
            width: 400px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .form-box {
            padding: 40px;
            text-align: center;
        }

        .form-box h2 {
            font-size: 28px;
            color: #fff;
            margin-bottom: 30px;
        }

        .input-group {
            position: relative;
            margin: 30px 0;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            outline: none;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
        }

        .input-group input::placeholder { color: rgba(255, 255, 255, 0.7); }

        .input-group label {
            position: absolute;
            top: 50%; left: 15px;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.8);
            pointer-events: none;
            transition: 0.3s;
        }

        .input-group input:focus ~ label,
        .input-group input:valid ~ label {
            top: -10px; left: 10px; font-size: 12px;
            background: linear-gradient(135deg, #71b7e6, #9b59b6);
            padding: 0 5px;
        }

        .error { color: #ff6b6b; font-size: 13px; margin-top: 6px; text-align: left; min-height: 18px; display: block; }
        .success { color: #a8ffbc; font-size: 14px; margin-top: 10px; text-align: center; }

        button {
            width: 100%; padding: 12px; background: #fff; border: none; border-radius: 8px;
            font-size: 16px; font-weight: 600; color: #9b59b6; cursor: pointer; margin-top: 15px;
        }

        button:hover { background: #f0f0f0; }

        .link { margin-top: 20px; color: #fff; }
        .link a { color: #fff; text-decoration: underline; cursor: pointer; }

        #register-form { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Form -->
        <div class="form-box" id="login-form">
            <h2>Login</h2>
            <form id="loginForm">
                <div class="input-group">
                    <input type="email" id="loginEmail" required>
                    <label>Email</label>
                    <span class="error" id="loginEmailError"></span>
                </div>
                <div class="input-group">
                    <input type="password" id="loginPassword" required>
                    <label>Password</label>
                    <span class="error" id="loginPasswordError"></span>
                </div>
                <span class="error" id="loginGeneralError"></span>
                <button type="submit">Login</button>
            </form>
            <p class="link">Don't have an account? <a onclick="switchToRegister()">Register</a></p>
        </div>

        <!-- Register Form -->
        <div class="form-box" id="register-form">
            <h2>Register</h2>
            <form id="registerForm">
                <div class="input-group">
                    <input type="text" id="regName" required>
                    <label>Full Name</label>
                    <span class="error" id="regNameError"></span>
                </div>
                <div class="input-group">
                    <input type="email" id="regEmail" required>
                    <label>Email</label>
                    <span class="error" id="regEmailError"></span>
                </div>
                <div class="input-group">
                    <input type="password" id="regPassword" required>
                    <label>Password</label>
                    <span class="error" id="regPasswordError"></span>
                </div>
                <div class="input-group">
                    <input type="password" id="regConfirm" required>
                    <label>Confirm Password</label>
                    <span class="error" id="regConfirmError"></span>
                </div>
                <span class="success" id="registerSuccess"></span>
                <button type="submit">Register</button>
            </form>
            <p class="link">Already have an account? <a onclick="switchToLogin()">Login</a></p>
        </div>
    </div>

    <script>
        function switchToRegister() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('register-form').style.display = 'block';
            clearAllErrors();
        }

        function switchToLogin() {
            document.getElementById('register-form').style.display = 'none';
            document.getElementById('login-form').style.display = 'block';
            clearAllErrors();
        }

        function clearAllErrors() {
            document.querySelectorAll('.error').forEach(el => el.textContent = '');
            document.getElementById('registerSuccess').textContent = '';
            document.getElementById('loginGeneralError').textContent = '';
        }

        // Real-time validation (same as before)
        // ... (keep all the input event listeners from previous version)

        document.getElementById('loginEmail').addEventListener('input', validateLoginEmail);
        document.getElementById('loginPassword').addEventListener('input', validateLoginPassword);
        document.getElementById('regName').addEventListener('input', validateRegName);
        document.getElementById('regEmail').addEventListener('input', validateRegEmail);
        document.getElementById('regPassword').addEventListener('input', validateRegPassword);
        document.getElementById('regConfirm').addEventListener('input', checkConfirmPassword);

        function validateLoginEmail() {
            const val = this.value.trim();
            const err = document.getElementById('loginEmailError');
            err.textContent = !val || !/\S+@\S+\.\S+/.test(val) ? 'Please enter a valid email' : '';
        }

        function validateLoginPassword() {
            const val = this.value;
            const err = document.getElementById('loginPasswordError');
            err.textContent = !val || val.length < 6 ? 'Password must be at least 6 characters' : '';
        }

        function validateRegName() {
            const val = this.value.trim();
            const err = document.getElementById('regNameError');
            err.textContent = !val || val.length < 3 ? 'Name must be at least 3 characters' : '';
        }

        function validateRegEmail() {
            const val = this.value.trim();
            const err = document.getElementById('regEmailError');
            err.textContent = !val || !/\S+@\S+\.\S+/.test(val) ? 'Please enter a valid email' : '';
        }

        function validateRegPassword() {
            const val = this.value;
            const err = document.getElementById('regPasswordError');
            err.textContent = !val || val.length < 6 ? 'Password must be at least 6 characters' : '';
            checkConfirmPassword();
        }

        function checkConfirmPassword() {
            const password = document.getElementById('regPassword').value;
            const confirm = document.getElementById('regConfirm').value;
            const err = document.getElementById('regConfirmError');
            err.textContent = confirm && password !== confirm ? 'Passwords do not match' : '';
        }

        // Register
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            ['regName', 'regEmail', 'regPassword', 'regConfirm'].forEach(id => 
                document.getElementById(id).dispatchEvent(new Event('input'))
            );

            const hasError = document.querySelector('#register-form .error').textContent !== '';
            if (hasError) return;

            const user = {
                name: document.getElementById('regName').value.trim(),
                email: document.getElementById('regEmail').value.trim().toLowerCase(),
                password: document.getElementById('regPassword').value
            };

            localStorage.setItem('user', JSON.stringify(user));
            document.getElementById('registerSuccess').textContent = 'Registration successful! Redirecting...';

            setTimeout(() => window.location.href = 'apps/dashboard.html', 1500);
        });

        // Login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            document.getElementById('loginEmail').dispatchEvent(new Event('input'));
            document.getElementById('loginPassword').dispatchEvent(new Event('input'));

            const email = document.getElementById('loginEmail').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;

            const stored = localStorage.getItem('user');
            if (!stored) {
                document.getElementById('loginGeneralError').textContent = 'No user registered yet.';
                return;
            }

            const user = JSON.parse(stored);
            if (user.email === email && user.password === password) {
                setTimeout(() => window.location.href = 'apps/dashboard.html', 500);
            } else {
                document.getElementById('loginGeneralError').textContent = 'Invalid email or password';
            }
        });
    </script>
</body>
</html>